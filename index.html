<!DOCTYPE html>
<html>
  <head>
    <title>Chase's Japan</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
      integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
      crossorigin=""
    />
    <link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500&family=Mukta:wght@500&display=swap" rel="stylesheet">
    <style>
      body {
        margin: 0;
        padding: 0;
      }

      #iiif-map {
        position: absolute;
        background-color: rgb(31, 30, 30);
        width: 65%;
        top: 0;
        bottom: 0;
      }

      #about {
        position: absolute;
        background-color: rgb(252, 245, 222);
        width: calc(35% - 20px);
        border-left: 5px groove rgb(255, 255, 253);
        padding: 10px;
        right: 0;
        top: 0;
        bottom: 0;
      }

      .h1 {
        color: rgb(31, 30, 30);
        font-family: 'Mukta', sans-serif;
        font-size: 35px;
        margin-left: 18px;
        margin-top: 2%;
        margin-bottom: 0%
      }
      
      .h2 {
        color: rgb(31, 30, 30);
        font-family: 'Mukta', sans-serif;
        font-size: 22px
      }

      .h3 {
        color: rgb(31, 30, 30);
        font-family: 'Montserrat', sans-serif;
        font-size: 17px;
        font-style: lighter;
        margin-left: 18px;
        margin-right: 18px;
        margin-top: 5px
      }

      #place-info {
        color: rgb(31, 30, 30);
        font-family: 'Montserrat', sans-serif;
        font-size: 15px;
        margin: 15px;
      }

      #current-view {
        position: absolute;
        left: 60px;
        top: 12px;
        z-index: 1000;
        background: whitesmoke;
        padding: 8px 12px;
      }

      #ui {
        padding: 8px 12px;
        border-bottom: 1px solid black;
        margin-top: 2%
      }

      #btn-back {
        width: 27%;
        border: none;
        border-radius: 6px;
        background-color: rgba(245, 33, 33, 0.856);
        color: white;
        font-size: 20px;
        font-family: 'Mukta', sans-serif;
        text-align: center;
        display: inline-block;
        padding: 5px 20px;
        margin-left: 3px;
        margin-right: 10%;
        margin-bottom: 20px
      }
      #btn-back:hover {
        box-shadow: 0 12px 16px 0 rgba(0,0,0,0.24), 0 17px 50px 0 rgba(0,0,0,0.19);
      }

      #btn-forward {
        width: 27%;
        border: none;
        border-radius: 6px;
        background-color: rgba(245, 33, 33, 0.856);
        color: white;
        font-size: 20px;
        font-family: 'Mukta', sans-serif;
        text-align: center;
        display: inline-block;
        padding: 5px 20px;
      }
      #btn-forward:hover {
        box-shadow: 0 12px 16px 0 rgba(0,0,0,0.24), 0 17px 50px 0 rgba(0,0,0,0.19);
      }

      .arrow {
  border: solid white;
  border-width: 0 3px 3px 0;
  display: inline-block;
  padding: 3px;
}

.right {
  transform: rotate(-45deg);
  -webkit-transform: rotate(-45deg);
}

.left {
  transform: rotate(135deg);
  -webkit-transform: rotate(135deg);
}
    </style>
  </head>

  <body>
    <section>
      <div>
        <div id="iiif-map"></div>
        <!-- <div id="current-view">
          Current bounds:<br />
          <div id="current-bounds"></div> -->
        </div>
      </div>
      <aside id="about">
        <section>
          <h1 class="h1">'Japan, the Target'</h1>
          <h3 class="h3">Looking closer at Ernest Dudley Chase's 1943 map</h3>
          <div id="ui">
            <button id="btn-back"><i class="arrow left"></i> Back</button>
            <button id="btn-forward">Forward <i class="arrow right"></i></button>
          </div>
          <div id="place-info">
            <h2 class="h2">About this project</h2>In 1943, World War II's Pacific Theater — the major theater of battle between the Allied forces and the Japanese Empire — had been underway for a year.
          </div>
        </section>
      </aside>
    </section>

    <script
      src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
      integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
      crossorigin=""
    ></script>

    <script
      src="https://code.jquery.com/jquery-3.5.1.min.js"
      integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
      crossorigin="anonymous"
    ></script>

    <script src="https://cdn.rawgit.com/mejackreed/Leaflet-IIIF/v3.0.0/leaflet-iiif.js"></script>

    <script>
      const map = L.map("iiif-map", {
        center: [0, 0],
        crs: L.CRS.Simple,
        zoom: 0,
      });

      const chamizalLayer = new L.tileLayer.iiif(
        "https://iiif.digitalcommonwealth.org/iiif/2/commonwealth:0r96fn437/info.json"
      ).addTo(map);

      // select the side panel div to insert info into later
      const placeInfo = $("#place-info");

      const backButton = $("#btn-back");
      const forwardButton = $("#btn-forward");

      // here we'll create markers for key places in the story
      const title = L.marker([-540, 331.3]).addTo(map);
      const legend = L.marker([-565, 164.1]).addTo(map);
      const target = L.marker([-118, 114.1]).addTo(map);
      const territory = L.marker([-238, 292]);
      const manchuria = L.marker([-77.3, 183.65]).addTo(map);
      const dutchHarbor = L.marker([-193.25, 426.4]).addTo(map);
      const tokyo = L.marker([-299.99, 378.2]).addTo(map);
      const tokyoDistance = L.marker([-473, 237.4]).addTo(map);
      const bombers = L.marker([-181.5, 326.6]).addTo(map);
      const hiroshima = L.marker([-329.86, 261.65]).addTo(map);

      // can use template strings for organizing text content
      const titleImg = '<img src="./images/twain.jpeg">';
      const manchuriaImg = '<a href="">printing and typesetting</a>';
      const dutchHarborImg = '';
      const tokyoImg = '';
      const bombersImg = '';
      const hiroshimaImg = '';

      // construct text string to be inserted into DOM
      const titleHtml = `<h3>Lexington is cool</h3><p>Lorem Ipsum is simply dummy text of the  industry. Lorem Ipsum has been the industrys standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book.</p>

          <p>It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</p>`;

      const legendHtml = `<h3>Frogs are cool</h3>There are many variations of passages of Lorem Ipsum available, but the majority have suffered alteration in some form, by injected humour, or randomised words which dont look even slightly believable. If you are going to use a passage of Lorem Ipsum, you need to be sure there isnt anything embarrassing hidden in the middle of text. All the Lorem Ipsum generators on the Internet tend to repeat predefined chunks as necessary, making this the first true generator on the Internet. It uses a dictionary of over 200 Latin words, combined with a handful of model sentence structures, to generate Lorem Ipsum which looks reasonable. The generated Lorem Ipsum is therefore always free from repetition, injected humour, or non-characteristic words etc.`;

      const targetHtml = `<h3>Halley's Cometis rad</h3><p>So beautiful ...</p>`;

      const territoryHtml = `<h3>Halley's Cometis rad</h3><p>So beautiful ...</p>`;

      const manchuriaHtml = `<h3>Halley's Cometis rad</h3><p>So beautiful ...</p>`;

      const dutchHarborHtml = `<h3>Halley's Cometis rad</h3><p>So beautiful ...</p>`;

      const tokyoHtml = `<h3>Halley's Cometis rad</h3><p>So beautiful ...</p>`;

      const tokyoDistanceHtml = `<h3>Halley's Cometis rad</h3><p>So beautiful ...</p>`;

      const bombersHtml = `<h3>Halley's Cometis rad</h3><p>So beautiful ...</p>`;

      const hiroshimaHtml = `<h3>Halley's Cometis rad</h3><p>So beautiful ...</p>`;

      // function to be called when both clicking on marker and
      // when using UI buttons to move fowward and back
      function triggerTitle() {
        // replace exisiting HTML content in the side panel
        placeInfo.html(titleHtml);
        // fly the map to that location
        map.flyTo(title.getLatLng(), 2);
      }

      function triggerLegend() {
        placeInfo.html(legendHtml);
        map.flyTo(legend.getLatLng(), 3);
      }

      function triggerTarget() {
        placeInfo.html(targetHtml);
        map.flyTo(target.getLatLng(), 3);
      }

      function triggerTerritory() {
        placeInfo.html(territoryHtml);
        map.flyTo(territory.getLatLng(), 1);
      }

      function triggerManchuria() {
        placeInfo.html(manchuriaHtml);
        map.flyTo(manchuria.getLatLng(), 3);
      }

      function triggerDutchHarbor() {
        placeInfo.html(dutchHarborHtml);
        map.flyTo(dutchHarbor.getLatLng(), 3.6);
      }

      function triggerTokyo() {
        placeInfo.html(tokyoHtml);
        map.flyTo(tokyo.getLatLng(), 3);
      }

      function triggerTokyoDistance() {
        placeInfo.html(tokyoDistanceHtml);
        map.flyTo(tokyoDistance.getLatLng(), 3);
      }

      function triggerBombers() {
        placeInfo.html(bombersHtml);
        map.flyTo(bombers.getLatLng(), 3.5);
      }

      function triggerHiroshima() {
        placeInfo.html(hiroshimaHtml);
        map.flyTo(hiroshima.getLatLng(), 4);
      }

      // on marker click, trigger Lex event
      title.on("click", () => {
        triggerTitle();
      });

      legend.on("click", () => {
        triggerLegend();
      });

      target.on("click", () => {
        triggerTarget();
      });

      territory.on("click", () => {
        triggerTerritory();
      });

      manchuria.on("click", () => {
        triggerManchuria();
      });

      dutchHarbor.on("click", () => {
        triggerDutchHarbor();
      });

      tokyo.on("click", () => {
        triggerTokyo();
      });

      tokyoDistance.on("click", () => {
        triggerTokyoDistance();
      });

      bombers.on("click", () => {
        triggerBombers();
      });

      hiroshima.on("click", () => {
        triggerHiroshima();
      });

      // use a list to dictate order of story
      const story = [
        "title",
        "legend",
        "target",
        "territory",
        "manchuria",
        "dutchHarbor",
        "tokyo",
        "tokyoDistance",
        "bombers",
        "hiroshima",
      ];

      let counter = 0;

      // object mapping the name of the places in the story to the function to be triggered
      const storyMap = {
        title: triggerTitle,
        legend: triggerLegend,
        target: triggerTarget,
        territory: triggerTerritory,
        manchuria: triggerManchuria,
        dutchHarbor: triggerDutchHarbor,
        tokyo: triggerTokyo,
        tokyoDistance: triggerTokyoDistance,
        bombers: triggerBombers,
        hiroshima: triggerHiroshima,
      };

      // forward button increments counter and calls appropriate trigger function
      forwardButton.on("click", () => {
        console.log("before: counter: ", counter, "object: ", story[counter]);
        if (counter < story.length) {
          storyMap[story[counter]]();
        }
        if (counter < story.length - 1) {
          counter++;
        }
        console.log("after: counter:", counter, "object: ", story[counter]);
      });

      // backward button decreases value of counter and calls appropriate trigger function
      backButton.on("click", () => {
        console.log("before: counter: ", counter, "object: ", story[counter]);
        if (counter > 0) {
          counter--;
          storyMap[story[counter]]();
        }
        console.log("after: counter: ", counter, "object: ", story[counter]);
      });

      // map.on("mousemove", (e) => {
      //   console.log(e.latlng);
      // });
    </script>
  </body>
</html>
