<!DOCTYPE html>
<html>
  <head>
    <title>Chase's Japan</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
      integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
      crossorigin=""
    />
    <style>
      body {
        margin: 0;
        padding: 0;
      }

      #iiif-map {
        position: absolute;
        background-color: rgb(255, 254, 254);
        width: 65%;
        top: 0;
        bottom: 0;
      }

      #about {
        position: absolute;
        background-color: rgb(255, 255, 255);
        width: calc(35% - 13px);
        border-left: 3px groove white;
        padding: 10px;
        right: 0;
        top: 0;
        bottom: 0;
      }

      .h2 {
        color: black;
        font-size: 20px;
        padding: 5px;
      }

      /* .p {
        color: black;
        font-size: 14px;
        padding: 5px;
      } */

      #current-view {
        position: absolute;
        left: 60px;
        top: 12px;
        z-index: 1000;
        background: whitesmoke;
        padding: 8px 12px;
      }

      #ui {
        padding: 8px 12px;
      }

      button {
        width: 20%;
      }

      #btn-back {
        margin-right: 12px;
      }
    </style>
  </head>

  <body>
    <section>
      <div>
        <div id="iiif-map"></div>
        <div id="current-view">
          Current bounds:<br />
          <div id="current-bounds"></div>
        </div>
      </div>
      <aside id="about">
        <section>
          <h2 class="h2">ABOUT THIS MAP</h2>
          <div id="ui">
            <button id="btn-back">Back</button>
            <button id="btn-forward">Forward</button>
          </div>
          <div id="place-info">
            Intro text can be written here and then replaced when clicking on
            markers or navigating with back, forward UI.
          </div>
        </section>
      </aside>
    </section>

    <script
      src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
      integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
      crossorigin=""
    ></script>

    <script
      src="https://code.jquery.com/jquery-3.5.1.min.js"
      integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
      crossorigin="anonymous"
    ></script>

    <script src="https://cdn.rawgit.com/mejackreed/Leaflet-IIIF/v3.0.0/leaflet-iiif.js"></script>

    <script>
      const map = L.map("iiif-map", {
        center: [0, 0],
        crs: L.CRS.Simple,
        zoom: 0,
      });

      const chamizalLayer = new L.tileLayer.iiif(
        "https://iiif.digitalcommonwealth.org/iiif/2/commonwealth:0r96fn437/info.json"
      ).addTo(map);

      // select the side panel div to insert info into later
      const placeInfo = $("#place-info");

      const backButton = $("#btn-back");
      const forwardButton = $("#btn-forward");

      // here we'll create markers for key places in the story
      const title = L.marker([-569, 335.1]).addTo(map);
      const legend = L.marker([-565, 164.1]).addTo(map);
      const target = L.marker([-118, 114.1]).addTo(map);
      const territory = L.marker([-238, 292]);
      const manchuria = L.marker([-77.3, 183.65]).addTo(map);
      const dutchHarbor = L.marker([-193.25, 426.4]).addTo(map);
      const tokyo = L.marker([-299.99, 378.2]).addTo(map);
      const tokyoDistance = L.marker([-473, 237.4]).addTo(map);
      const bombers = L.marker([-181.5, 326.6]).addTo(map);
      const hiroshima = L.marker([-329.86, 261.65]).addTo(map);

      // construct text string to be inserted into DOM
      const titleHtml = `<h3>Lexington is cool</h3><p>Lorem Ipsum is simply dummy text of the  industry. Lorem Ipsum has been the industrys standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book.</p>

          <p>It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</p>`;

      const legendHtml = `<h3>Frogs are cool</h3>There are many variations of passages of Lorem Ipsum available, but the majority have suffered alteration in some form, by injected humour, or randomised words which dont look even slightly believable. If you are going to use a passage of Lorem Ipsum, you need to be sure there isnt anything embarrassing hidden in the middle of text. All the Lorem Ipsum generators on the Internet tend to repeat predefined chunks as necessary, making this the first true generator on the Internet. It uses a dictionary of over 200 Latin words, combined with a handful of model sentence structures, to generate Lorem Ipsum which looks reasonable. The generated Lorem Ipsum is therefore always free from repetition, injected humour, or non-characteristic words etc.`;

      const targetHtml = `<h3>Halley's Cometis rad</h3><p>So beautiful ...</p>`;

      const territoryHtml = `<h3>Halley's Cometis rad</h3><p>So beautiful ...</p>`;

      const manchuriaHtml = `<h3>Halley's Cometis rad</h3><p>So beautiful ...</p>`;

      const dutchHarborHtml = `<h3>Halley's Cometis rad</h3><p>So beautiful ...</p>`;

      const tokyoHtml = `<h3>Halley's Cometis rad</h3><p>So beautiful ...</p>`;

      const tokyoDistanceHtml = `<h3>Halley's Cometis rad</h3><p>So beautiful ...</p>`;

      const bombersHtml = `<h3>Halley's Cometis rad</h3><p>So beautiful ...</p>`;

      const hiroshimaHtml = `<h3>Halley's Cometis rad</h3><p>So beautiful ...</p>`;

      // function to be called when both clicking on marker and
          // when using UI buttons to move fowward and back
          function triggerTitle() {
            // replace exisiting HTML content in the side panel
            placeInfo.html(titleHtml);
            // fly the map to that location
            map.flyTo(title.getLatLng(), 3);
          }

          function triggerLegend() {
            placeInfo.html(legendHtml);
            map.flyTo(legend.getLatLng(), 3);
          }

          function triggerTarget() {
            placeInfo.html(targetHtml);
            map.flyTo(target.getLatLng(), 3);
          }

          function triggerTerritory() {
            placeInfo.html(territoryHtml);
            map.flyTo(territory.getLatLng(), 3);
          }

          function triggerManchuria() {
            placeInfo.html(manchuriaHtml);
            map.flyTo(manchuria.getLatLng(), 3);
          }

          function triggerDutchHarbor() {
            placeInfo.html(dutchHarborHtml);
            map.flyTo(dutchHarbor.getLatLng(), 3);
          }

          function triggerTokyo() {
            placeInfo.html(tokyoHtml);
            map.flyTo(tokyo.getLatLng(), 3);
          }

          function triggerTokyoDistance() {
            placeInfo.html(tokyoDistanceHtml);
            map.flyTo(tokyoDistance.getLatLng(), 3);
          }

          function triggerBombers() {
            placeInfo.html(bombersHtml);
            map.flyTo(bombers.getLatLng(), 3);
          }

          function triggerHiroshima() {
            placeInfo.html(hiroshimaHtml);
            map.flyTo(hiroshima.getLatLng(), 3);
          }

          // on marker click, trigger Lex event
          title.on('click', () => {
            triggerTitle();
          });

          legend.on('click', () => {
            triggerLegend();
          });

          // // use a list to dictate order of story
          // const story = ['title', 'legend', 'target',];

      let counter = 0;

      //    // object mapping the name of the places in the story
      // // to the function to be triggered
      // const storyMap = {
      //   lex: triggerLex,
      //   frog: triggerFrog,
      //   comet: triggerComet
      // }

      //  // forward button increments counter and calls appropriate trigger function
      //  forwardButton.on('click', () => {
      //   console.log('before: counter: ', counter, 'object: ', story[counter]);
      //   if (counter < story.length) {
      //     storyMap[story[counter]]();
      //   }
      //   if (counter < story.length - 1) {
      //     counter++;
      //   }
      //   console.log('after: counter:', counter, 'object: ', story[counter]);
      // });

      // // backward button decreases value of counter and calls appropriate trigger function
      // backButton.on('click', () => {
      //   console.log('before: counter: ', counter, 'object: ', story[counter]);
      //   if (counter > 0) {
      //     counter--;
      //     storyMap[story[counter]]();
      //   }
      //   console.log('after: counter: ', counter, 'object: ', story[counter]);
      // });

      // map.on("moveend", () => {
      //   // returns 'southwest_lng,southwest_lat,northeast_lng,northeast_lat' of current view
      //   const currentBounds = map.getBounds().toBBoxString();
      // use this to determine mouse position
      // can then use coords to create markers, etc.
      map.on("mousemove", (e) => {
        console.log(e.latlng);
      });

      //   // output current bounds to screen
      //   document.getElementById("current-bounds").innerText = currentBounds;
      // });

      // document.getElementById("btn-forward").addEventListener("click", () => {
      //   map.flyToBounds([
      //     // title japan the target
      //     [-642.22, 199.27],
      //     [-454.97, 451.27],
      //   ]);
      // });
      //   map.flyToBounds([ // legend
      //     [-612.37, 99.96],
      //     [-518.75, 225.96],
      //   ]);
      //   map.flyToBounds([ // top left rising sun as target
      //     [-162.81, 45.38],
      //     [-69.18, 171.38],
      //   ])
      //   map.flyToBounds([ // japan territory as yellow, other as green
      //     [-413.785, -59.73],
      //     [-39.285, 444.27],
      //   ])
      //   map.flyToBounds([ // munchuria as object of liberation
      //     [-127.965, 124.11],
      //     [-34.34, 250.11],
      //   ])
      //   map.flyToBounds([ // distance from dutch harbor and allied bases
      //     [-248.62, 361.86],
      //     [-154.96, 487.86],
      //   ])
      //   map.flyToBounds([ // tokyo as center of target. 80 represents mupltiples of 100k, noting its 8 million pop. red circles with anchors are naval bases
      //     [-350.13, 310.12],
      //     [-256.51, 436.19],
      //   ])
      //   map.flyToBounds([ // "tokyo to any point on this circle"
      //     [-536.37, 166.38],
      //     [-442.75, 292.38],
      //   ])
      //   map.flyToBounds([ // bombers circling tokyo, b26 "consolidated liberator"
      //     [-449.46, 250.47],
      //     [-355.84, 376.47],
      //   ])
      //   map.flyToBounds([ // hiroshima and nagasaki
      //     [-394.88, 181.43],
      //     [-301.26, 307.43],
      //   ])
    </script>
  </body>
</html>
